@use '@carbon/layout';
@use '@carbon/type';
@use '~@openmrs/esm-styleguide/src/vars';

$ui-01: #ffffff !default;
$ui-02: #f4f4f4 !default;
$ui-03: #dcdcdc !default;
$ui-04: #8d8d8d !default;
$text-02: #525252 !default;
$disabled-01: #f4f4f4 !default;
$disabled-02: #c6c6c6 !default;
$disabled-03: #8d8d8d !default;

.container {
  width: 100%;
  max-width: 100%;
  display: flex;
  flex-direction: column;
  background: $ui-01;
  height: auto;
  overflow: hidden;
}

.tableHeader {
  margin-bottom: layout.$spacing-05;
  padding: 0 layout.$spacing-05;

  h4 {
    font-size: 1.125rem;
    font-weight: 600;
    margin-bottom: layout.$spacing-03;
  }
}

.headerTitleContainer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  margin-bottom: layout.$spacing-03;
}

.headerTitleInfo {
  display: flex;
  flex-direction: column;
}

.headerActions {
  display: flex;
  gap: 1rem;
  align-items: center;
}

.insuranceDetailsSection {
  margin-bottom: layout.$spacing-05;
  padding: 0 layout.$spacing-05;
  overflow: hidden !important;
  width: 100% !important;
  max-width: 100% !important;
}

.accordionContainer {
  margin: layout.$spacing-05 0;
  width: 100%;

  :global(.cds--accordion__item) {
    border-bottom: 1px solid $ui-03;
  }

  :global(.cds--accordion__heading) {
    background-color: $ui-01;

    &:hover {
      background-color: $ui-02;
    }
  }

  :global(.cds--accordion__content) {
    padding-inline: 0 !important;      
    padding-block: layout.$spacing-04; 
    background-color: $ui-01;
  }
}

.accordionTitle {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  padding-block: layout.$spacing-03;

  .consommationInfo {
    display: flex;
    gap: layout.$spacing-05;
    align-items: center;
    flex: 1;
    min-width: 0;

    .consommationId {
      font-weight: 600;
      color: #0f62fe;
      font-size: 0.875rem;
      white-space: nowrap;
    }

    .consommationService {
      font-weight: 500;
      color: #161616;
      font-size: 0.875rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .consommationDate {
      color: $text-02;
      font-size: 0.75rem;
      white-space: nowrap;
    }
  }

  .consommationStatus {
    margin-left: auto;
    flex-shrink: 0;
  }
}

.consommationItems {
  background-color: #f8f9fa;
  padding-inline: 0 !important;
  padding-block: layout.$spacing-03;
}

/* Loading / empty states */
.loadingItems {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 2rem;
}

.noItems {
  text-align: center;
  padding: 2rem;
  color: #6f6f6f;
  font-style: italic;
}

/* ---------- Table wrapper ---------- */
.itemsTable {
  width: 100% !important;
  max-width: 100% !important;
  overflow-x: hidden; // weâ€™ll wrap content instead of scrolling
  background-color: #fff;
  border-radius: 4px;
  border: 1px solid #ececec;
  margin: 0;
}

/* ---------- Actual table ---------- */
.itemsDataTable {
  width: 100% !important;
  max-width: 100% !important;
  border-collapse: collapse;
  table-layout: auto;
  margin: 0 !important;

  th,
  td {
    padding: 0.5rem 0.375rem;
    text-align: left;
    border-bottom: 1px solid #e0e0e0;
    font-size: 0.825rem;
    line-height: 1.2;
    white-space: normal;
    overflow: visible;
    text-overflow: clip;
  }

  /* Header */
  th {
    background-color: #f4f4f4;
    font-weight: 600;
    color: #161616;
  }

  /* Column alignment without forcing widths */
  tbody td:nth-child(1) { text-align: center; width: 36px; }
  tbody td:nth-last-child(6),
  tbody td:nth-last-child(5),
  tbody td:nth-last-child(4),
  tbody td:nth-last-child(3) { text-align: right; }
  tbody td:nth-last-child(2) { text-align: center; }

  /* Hover */
  tbody tr:hover {
    background-color: #f8f9fa;
  }

  /* Edge padding trims to prevent overflow caused by cell padding */
  th:first-child,
  td:first-child {
    padding-left: 0.375rem;
  }
  th:last-child,
  td:last-child {
    padding-right: 0.375rem;
  }
}

/* Selected row */
.selectedItemRow {
  background-color: #e8f4ff !important;
  border-left: 3px solid #0f62fe;
}

/* Item name clamp */
.itemNameCell {
  overflow: visible;
  text-overflow: clip;
  white-space: normal;
  word-break: break-word;
}

/* Status tag baseline */
.statusBadge {
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  display: inline-block;
  min-width: 60px;
  text-align: center;
}

/* ---------- Actions ---------- */
.actionsContainer {
  background-color: #fff;
  padding: 1rem;
  border-radius: 8px;
  border: 1px solid #ececec;
}

.paymentActions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.selectedSummary {
  color: #161616;
  font-weight: 500;
  margin: 0;
  flex: 1;
  min-width: 200px;
}

.actionButtons {
  display: flex;
  gap: 1rem;
}

.revertButton {
  color: #da1e28; // IBM Red 60 for danger/warning actions
  
  &:hover:not(:disabled) {
    background-color: #fff1f1; // Light red background on hover
    color: #b81921; // Darker red on hover
  }
  
  &:disabled {
    color: $disabled-03;
    cursor: not-allowed;
  }
}

/* ---------- Empty state ---------- */
.emptyStateContainer {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 3rem 1rem;
  background-color: #fff;
  border-radius: 8px;
  border: 1px solid #ececec;
  text-align: center;
}

.noData {
  color: #6f6f6f;
  font-size: 1.125rem;
  margin-bottom: 1.5rem;
}

/* ---------- Responsive ---------- */
@media (max-width: 768px) {
  .container {
    padding: 0.5rem;
  }

  .paymentActions {
    flex-direction: column;
    align-items: stretch;
  }

  .selectedSummary {
    text-align: center;
    margin-bottom: 1rem;
  }

  .actionButtons {
    justify-content: center;
  }

  .accordionTitle {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }

  .consommationInfo {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.25rem;
  }

  .itemsDataTable {
    th,
    td {
      padding: 0.5rem 0.25rem;
      font-size: 0.75rem;
      white-space: normal;
    }
  }
}
